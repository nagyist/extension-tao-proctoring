define("taoProctoring/controller/routes",[],function(){return{TaoProctoring:{actions:{index:"controller/TaoProctoring/index"}},ProctorDelivery:{actions:{index:"controller/ProctorDelivery/index",testTakers:"controller/ProctorDelivery/testTakers"}}}}),define("taoProctoring/controller/ProctorDelivery/index",["jquery","i18n","helpers","layout/loading-bar","util/encode","ui/feedback","ui/dialog","ui/datatable"],function($,__,helpers,loadingBar,encode,feedback,dialog){"use strict";var cssScope=".delivery-manager";loadingBar.start();var proctorDeliveryIndexCtlr={start:function(){var $list=$(cssScope+" .list"),dataset=$list.data("set"),deliveryId=$list.data("id"),assignUrl=helpers._url("testTakers","ProctorDelivery","taoProctoring",{
id:deliveryId}),removeUrl=helpers._url("remove","ProctorDelivery","taoProctoring",{id:deliveryId}),serviceUrl=(helpers._url("authorise","ProctorDelivery","taoProctoring",{id:deliveryId}),helpers._url("deliveryTestTakers","ProctorDelivery","taoProctoring",{id:deliveryId})),request=function(url,selection,message){selection&&selection.length&&(loadingBar.start(),$.ajax({url:url,data:{tt:selection},dataType:"json",type:"POST",error:function(){loadingBar.stop()}}).done(function(response){loadingBar.stop(),response&&response.success?(message&&feedback().success(message),$list.datatable("refresh")):feedback().error(__("Something went wrong ...")+"<br>"+encode.html(response.error),{
encodeHtml:!1})}))},authorise=function(selection){dialog({message:__("Not yet implemented!"),autoRender:!0,autoDestroy:!0,buttons:"ok"})},remove=function(selection){request(removeUrl,selection,__("Test takers have been removed"))};$list.on("query.datatable",function(){loadingBar.start()}).on("load.datatable",function(){loadingBar.stop()}).datatable({url:serviceUrl,data:dataset,status:{empty:__("No assigned test takers"),available:__("Assigned test takers"),loading:__("Loading")},tools:[{id:"assign",icon:"add",title:__("Assign test takers to this delivery"),label:__("Add test takers"),action:function(){location.href=assignUrl}},{id:"authorise",icon:"checkbox-checked",
title:__("Authorise the selected test takers to run the delivery"),label:__("Authorise"),massAction:!0,action:function(selection){dialog({message:__("The test takers will be authorized to start this delivery. Continue ?"),autoRender:!0,autoDestroy:!0,onOkBtn:function(){authorise(selection)}})}},{id:"remove",icon:"remove",title:__("Remove the selected test takers from the delivery"),label:__("Remove"),massAction:!0,action:function(selection){dialog({message:__("The test takers will be removed from this delivery. Continue ?"),autoRender:!0,autoDestroy:!0,onOkBtn:function(){remove(selection)}})}}],actions:[{id:"authorise",icon:"checkbox-checked",title:__("Authorise the test taker to run the delivery"),
hidden:function(){return!!this.authorised},action:function(id){dialog({message:__("The test taker will be authorized to start this delivery. Continue ?"),autoRender:!0,autoDestroy:!0,onOkBtn:function(){authorise([id])}})}},{id:"remove",icon:"remove",title:__("Remove the test taker from the delivery"),action:function(id){dialog({autoRender:!0,autoDestroy:!0,message:__("The test taker will be removed from this delivery. Continue ?"),onOkBtn:function(){remove([id])}})}}],selectable:!0,model:[{id:"firstname",label:__("First name")},{id:"lastname",label:__("Last name")},{id:"company",label:__("Company name")},{id:"status",label:__("Status")}]})}};return proctorDeliveryIndexCtlr;
}),define("taoProctoring/controller/ProctorDelivery/testTakers",["jquery","i18n","helpers","layout/loading-bar","util/encode","ui/feedback","ui/datatable"],function($,__,helpers,loadingBar,encode,feedback){"use strict";var cssScope=".assign-test-takers";loadingBar.start();var proctorDeliveryAssignCtlr={start:function(){var $list=$(cssScope+" .list"),dataset=$list.data("set"),deliveryId=$list.data("id"),serviceUrl=helpers._url("availableTestTakers","ProctorDelivery","taoProctoring",{id:deliveryId}),assignUrl=helpers._url("assign","ProctorDelivery","taoProctoring",{id:deliveryId}),indexUrl=helpers._url("index","ProctorDelivery","taoProctoring",{id:deliveryId}),assign=function(selection){
selection&&selection.length&&(loadingBar.start(),$.ajax({url:assignUrl,data:{tt:selection},dataType:"json",type:"POST",error:function(){loadingBar.stop()}}).done(function(response){loadingBar.stop(),response&&response.success?(feedback().success(__("Test takers have been added")),location.href=indexUrl):feedback().error(__("Something went wrong ...")+"<br>"+encode.html(response.error),{encodeHtml:!1})}))};$list.on("query.datatable",function(){loadingBar.start()}).on("load.datatable",function(event,response){loadingBar.stop()}).datatable({url:serviceUrl,data:dataset,status:{empty:__("No available test takers to assign"),available:__("Available test takers"),loading:__("Loading")
},tools:[{id:"back",icon:"left",title:__("Return to the delivery"),label:__("Back"),action:function(){history.back()}},{id:"assign",icon:"add",title:__("Assign the selected test takers to the delivery"),label:__("Assign the selected test takers"),massAction:!0,action:function(selection){assign(selection)}}],actions:[{id:"assign",icon:"add",title:__("Assign the test taker to the delivery"),action:function(id){assign([id])}}],selectable:!0,model:[{id:"firstname",label:__("First name")},{id:"lastname",label:__("Last name")},{id:"company",label:__("Company name")}]})}};return proctorDeliveryAssignCtlr}),define("tpl!taoProctoring/tpl/entryPoint",["handlebars"],function(hb){
return hb.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <li>\n        <a class="block entry-point" href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n            <h3>',(helper=helpers.label)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.label,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h3>\n            ",
stack1=helpers["if"].call(depth0,depth0&&depth0.content,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            <div class="clearfix">\n                <span class="text-link" href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"><span class="icon-play"></span>',(helper=helpers.text)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.text,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},
data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n            </div>\n        </a>\n    </li>\n    "}function program2(depth0,data){var stack1,helper,buffer="";return buffer+='<div class="clearfix">',(helper=helpers.content)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.content,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<ul class="entry-point-box plain">\n    ',
stack1=helpers.each.call(depth0,depth0&&depth0.entries,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("taoProctoring/controller/TaoProctoring/index",["jquery","helpers","layout/loading-bar","tpl!taoProctoring/tpl/entryPoint"],function($,helpers,loadingBar,entryPointTpl){"use strict";var refreshPolling=6e4,cssScope=".deliveries-listing",hiddenCls="hidden";loadingBar.start();var taoProctoringCtlr={start:function(){var $titleLoading=$(cssScope+" .loading"),$titleEmpty=$(cssScope+" .empty-list"),$titleAvailable=$(cssScope+" .available-list"),$titleCount=$(cssScope+" .count"),$list=$(cssScope+" .list"),listEntries=$list.data("list"),serviceUrl=helpers._url("deliveries","TaoProctoring","taoProctoring"),pollTo=null,update=function(entries){
pollTo&&(clearTimeout(pollTo),pollTo=null),$titleLoading.addClass(hiddenCls),$list.empty(),entries&&entries.length?($titleAvailable.removeClass(hiddenCls),$list.append(entryPointTpl({entries:entries})),$titleCount.text(entries.length),$titleEmpty.addClass(hiddenCls)):($titleEmpty.removeClass(hiddenCls),$titleAvailable.addClass(hiddenCls)),loadingBar.stop(),refreshPolling&&(pollTo=setTimeout(refresh,refreshPolling))},refresh=function(){loadingBar.start(),$titleLoading.removeClass(hiddenCls),$.ajax({url:serviceUrl,data:{_cb:Date.now()},dataType:"json",type:"GET"}).done(function(response){listEntries=response&&response.entries,update(listEntries)})};listEntries?update(listEntries):refresh();
}};return taoProctoringCtlr});
//# sourceMappingURL=controllers.min.js.map